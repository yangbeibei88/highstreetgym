{"version":3,"file":"src_components_BlogSearchAndFilter_js.bundle.js","mappings":";;;;;;;;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AAEA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AAGA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AAGA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAgCA;AAGA;AACA;AACA;AAAA;AAAA","sources":["webpack://hsg_frontend/./src/components/BlogSearchAndFilter.js"],"sourcesContent":["export class BlogSearchAndFilter {\n  constructor() {\n    this._topicFilterEl = document.querySelector(\"#articleFilter #topicFilter\");\n    this._visFilterEl = document.querySelector(\"#articleFilter #visFilter\");\n    this._articleList = document.querySelector(\"#blog #articleList\");\n    this._blogFilterEls = document.querySelectorAll(\"#blogFilterBy details\");\n    if (!this._topicFilterEl || !this._articleList) {\n      return;\n    }\n    this.handleSearchFilter();\n    this.initializeListeners();\n    this.toggleFilters();\n  }\n\n  initializeListeners() {\n    this._topicFilterEl.addEventListener(\"change\", () =>\n      this.handleSearchFilter(),\n    );\n    this._visFilterEl.addEventListener(\"change\", () =>\n      this.handleSearchFilter(),\n    );\n    window.addEventListener(\"resize\", () => this.toggleFilters());\n  }\n\n  toggleFilters() {\n    const screenWidth = window.innerWidth;\n    this._blogFilterEls.forEach((el) => {\n      if (screenWidth < 768) {\n        el.removeAttribute(\"open\");\n      } else {\n        el.setAttribute(\"open\", \"\");\n      }\n    });\n  }\n\n  getSelectedTopics() {\n    const selectedTopics = [];\n    const checkBoxes = this._topicFilterEl.querySelectorAll(\n      \"input[type='checkbox']:checked\",\n    );\n    checkBoxes.forEach((checkbox) => selectedTopics.push(checkbox.value));\n\n    return selectedTopics;\n  }\n\n  getSelectedViss() {\n    const selectedViss = [];\n    const checkBoxes = this._visFilterEl.querySelectorAll(\n      \"input[type='checkbox']:checked\",\n    );\n    checkBoxes.forEach((checkbox) => selectedViss.push(checkbox.value));\n\n    return selectedViss;\n  }\n\n  buildQuery() {\n    const selectedTopics = this.getSelectedTopics();\n    const selectedViss = this.getSelectedViss();\n    // eslint-disable-next-line node/no-unsupported-features/node-builtins\n    return new URLSearchParams({\n      topics: selectedTopics.length > 0 ? selectedTopics.join(\",\") : \"\",\n      visibilities: selectedViss.length > 0 ? selectedViss.join(\",\") : \"\",\n    }).toString();\n  }\n\n  async fetchArticles(query) {\n    try {\n      const res = await fetch(`/blog/search-filter?${query}`);\n      const data = await res.json();\n      // console.log(data);\n      this.updateArticleList(data.articles);\n    } catch (error) {\n      console.error(`Fetch articles error: `, error);\n    }\n  }\n\n  handleSearchFilter() {\n    const query = this.buildQuery();\n    this.fetchArticles(query);\n  }\n\n  updateArticleList(articles) {\n    this._articleList.innerHTML = \"\";\n\n    if (articles.length === 0) {\n      this._articleList.textContent = \"No article found.\";\n      return;\n    }\n\n    articles.forEach((item) => {\n      const row = document.createElement(\"article\");\n      row.innerHTML = `\n            <img\n          src=\"/images/blog/${item.imageCover}\"\n          alt=\"${item.articleTitle}\"\n          class=\"max-h-52 object-cover rounded-t-lg md:max-h-full md:rounded-tr-none md:rounded-l-lg md:w-1/3\">\n        <div\n          class=\"w-full py-4 px-2 flex flex-col md:w-2/3\">\n          <small\n            class=\"text-xs font-semibold bg-orange-700 text-white rounded-full w-fit px-3 py-1\">${item.topicName}</small>\n          <h2 class=\"text-xl\">${item.articleTitle}</h2>\n          <div class=\"shortDesc\">\n            <div class=\"line-clamp-3\">${item.articleContent}</div>\n          <div>\n          <div\n            class=\"w-full flex flex-col items-center justify-between lg:flex-row\">\n            <div\n              class=\"flex items-center space-x-2 mr-auto\">\n              <img\n                src=\"/images/users/${item.avatar}\"\n                alt=\"${item.firstName}\"\n                class=\"size-8 rounded-full border border-darkCyan object-cover md:size-12\">\n              <small class=\"text-xs\">${item.firstName} ${item.lastName}</small>\n              <small\n                class=\"text-xs\">${new Date(item.createdAt).toLocaleDateString(\"en-AU\")}</small>\n            </div>\n            <a class=\"btn-bullet btn-limeGreen btn-sm ml-auto\"\n              href=\"/blog/${item.articleId}\">\n              Read\n              More &gt;&gt;</a>\n          </div>\n        </div>\n      `;\n      row.classList =\n        \"flex flex-col rounded-lg bg-white shadow md:flex-row md:space-x-4\";\n\n      this._articleList.appendChild(row);\n    });\n  }\n}\n"],"names":[],"sourceRoot":""}